{{> layout/header}}


<!--공고 검색페이지-->


<!--리펙토링 코드-->
<div class="container d-flex justify-content-between">
    <div class="card-body">
        <div>
            <h2>
                총 <span id="totalJobs">00</span>건의 공고
            </h2>
        </div>
        <div>

            <form id="searchForm" action="/guest/jobopenSearch" method="get">
                <div class="my-3">
                    <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                            data-bs-target="#demo">
                        공고필터
                    </button>
                </div>
                <!-- 구직자 기술스택 매칭리스트 목록 -->

                <div id="demo" class="mt-3 collapse ">
                    <div class="select-box">
                        <div class="select-package p-3 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#skills">
                                기술스택
                            </button>
                            <div id="skills" class="checkbox-package collapse">
                                <input id="btn" type="button"
                                       class="btn btn-lg btn-outline-info mx-1"
                                       value="Java"
                                       onclick="skillsFilter(this);"/>
                                <input id="btn" type="button"
                                       class="btn btn-lg btn-outline-info mx-1"
                                       value="JavaScript"
                                       onclick="skillsFilter(this);"/>
                                <input id="btn" type="button" class="btn btn-outline-info btn-lg mx-1"
                                       value="Spring"
                                       onclick="skillsFilter(this);"/>
                                <input id="btn" type="button" class="btn btn-outline-info btn-lg mx-1"
                                       value="HTML"
                                       onclick="skillsFilter(this);"/>
                                <input id="btn" type="button" class="btn btn-outline-info btn-lg mx-1"
                                       value="jQuery"
                                       onclick="skillsFilter(this);"/>
                                <input id="btn" type="button" class="btn btn-outline-info btn-lg mx-1"
                                       value="MySQL"
                                       onclick="skillsFilter(this);"/>
                            </div>

                        </div>

                        <div class="select-package p-3 m-2 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#career">
                                경력
                            </button>
                            <div id="career" class="checkbox-package collapse">
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="career" value="신입"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="career" value="경력"/>
                            </div>
                        </div>
                        <div class="select-package p-3 m-2 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#compLocation">
                                지역
                            </button>
                            <div id="compLocation" class="checkbox-package collapse">
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="compLocation" value="서울"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="compLocation" value="경기"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="compLocation" value="광주"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="compLocation" value="부산"/>
                            </div>
                        </div>
                        <div class="select-package p-3 m-2 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#edu">
                                학력
                            </button>
                            <div id="edu" class="checkbox-package collapse">
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1" name="edu"
                                       value="고졸"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1" name="edu"
                                       value="대졸"/>
                            </div>
                        </div>
                        <div class="select-package p-3 m-2 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#salary">
                                연봉
                            </button>
                            <div id="salary" class="checkbox-package collapse">
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="salary" value="협의"/>

                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="salary" value="3,000만원 이하"/>

                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="salary" value="5,000만원 이상"/>

                            </div>
                        </div>
                        <div class="select-package p-3 m-2 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#hopeJob">
                                희망 직무
                            </button>
                            <div id="hopeJob" class="checkbox-package collapse">
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="hopeJob" value="프론트엔드"/>

                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="hopeJob" value="백엔드"/>
                            </div>
                        </div>
                        <div class="select-package p-3 m-2 rounded-3 shadow d-flex align-items-center">
                            <button type="button" class="btn btn-lg btn-primary" data-bs-toggle="collapse"
                                    data-bs-target="#jobType">
                                고용형태
                            </button>
                            <div id="jobType" class="p-3 checkbox-package collapse">
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="jobType" value="정규직"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="jobType" value="계약직"/>
                                <input type="button" id="btn" class="btn btn-outline-info btn-lg mx-1"
                                       name="jobType" value="인턴"/>
                            </div>
                        </div>


                        <div class="text-center my-5"> <!-- 가운데 정렬 및 위아래 여백 추가 -->
                            <input type="hidden" name="skills" id="skillsInput">
                            <button type="submit" class="btn btn-lg btn-primary mx-2" onclick="applyFilters()">
                                <!-- 좌우 여백만 추가 -->
                                필터 적용하기
                            </button>
                        </div>
                    </div>
                </div>

            </form>

            <!-- 구직자 기술스택 매칭리스트 목록 -->

            <!-- 채용공고 목록 -->
            <div class="row">
                {{#jobopenList}}
                    <div class="col-md-4 mb-4">
                        <a onClick="location.href='/comp/jobopen/{{id}}'" class="btn">
                            <div class="card col-3 border-0 shadow" style="width: 100%;">
                                <img src="#" style="width: 400px; height: 200px; " alt="이미지를 표시할 수 없습니다.">
                                <div class="card-body text-start">
                                    <br>
                                    {{compname}}
                                    <h5 class="card-title">{{jobopenTitle}}</h5>
                                    <hr>
                                    <p class="card-text">{{compLocation}} {{career}} {{edu}}</p>
                                </div>
                            </div>
                        </a>
                    </div>
                {{/jobopenList}}

            </div>
            <!-- 채용공고 목록 -->


            <!-- 페이징 -->
            <div class="mt-5">
                <ul class="pagination justify-content-center">
                    <li class="page-item disabled text-info bg-light border-dark">
                        <a class="page-link text-info bg-light" href="#">Previous</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link text-info bg-light" href="#">1</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link text-info bg-light" href="#">2</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link text-info bg-light" href="#">3</a>
                    </li>
                    <li class="page-item">
                        <a class="page-link text-info bg-light" href="#">Next</a>
                    </li>
                </ul>
            </div>
            <!-- 페이징 -->

        </div>
    </div>
</div>


<script>
    $(".btn").click(function () {
        $(this).toggleClass("active");
    })
    //기술스택 필터 적용
    var skillArr = []; //필터 내용을 저장하는 배열

    //필터 내용을 저장하는 function
    function skillsFilter(target) {
        var skillVal = target.value; // 버튼의 value 값
        var index = skillArr.findIndex(skill => skill.name === skillVal); // 배열에서 해당 기술의 인덱스 찾기

        // 버튼이 선택되었는지 확인
        if (index === -1) { // 선택되지 않았다면 추가
            skillArr.push({name: skillVal, selected: true});
        } else { // 이미 선택되었다면 선택 취소(배열에서 제거)
            skillArr.splice(index, 1);
        }

        console.log("필터 선택값 : ", JSON.stringify(skillArr));
    }

    function applyFilters() {
        var skillString = JSON.stringify(skillArr.map(skill => skill.name)); // 선택된 기술들의 이름만 추출하여 JSON 문자열로 변환
        document.getElementById("skillsInput").value = skillString; // 숨겨진 input에 값 설정

        // 폼 제출
        document.getElementById("searchForm").submit(); // 올바른 폼 ID를 사용
    }

</script>

{{> layout/footer}}